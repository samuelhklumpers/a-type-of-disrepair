<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">{-|
This module provides some wrappers for computing some statistics for your `DPProblem`.

Make sure your inputs are independent if you like having correct outputs.
-}</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Probability</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Probability.html#avg"><span class="hs-identifier">avg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier">HasMean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Probability.html#HasVariance"><span class="hs-identifier">HasVariance</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier">Mixture</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier">Log1P</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier">Mean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier">MaxMean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier">MinMean</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier">Variance</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="annot"><span class="hs-comment">{-|
A statistic `V :: X -&gt; v` supports mixtures if:
- there is a function $m$
- $f_X(x) = pf_Y(x) + (1-p)f_Z(x)$ implies $V[X] = m(p, V[Y], V[Z])

The method `weightedAvg` generalizes this to the $n$-ary case.
-}</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">class</span><span> </span><span id="Mixture"><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-var">Mixture</span></a></span></span><span> </span><span id="local-6989586621679066706"><span class="annot"><a href="#local-6989586621679066706"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-comment">-- | Compute the value of the statistic for a mixture of distributions.</span><span>
</span><span id="line-37"></span><span>    </span><span id="weightedAvg"><span class="annot"><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-type">weightedAvg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679066706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066706"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><span class="hs-comment">-- | Compute the value of the statistic for a uniform mixture of distributions.</span></span><span>
</span><span id="line-40"></span><span id="local-6989586621679066703"><span class="annot"><a href="Probability.html#avg"><span class="hs-identifier hs-type">avg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066703"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679066703"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066703"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-41"></span><span id="avg"><span class="annot"><span class="annottext">avg :: forall a. Mixture a =&gt; [a] -&gt; a
</span><a href="Probability.html#avg"><span class="hs-identifier hs-var hs-var">avg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, a)] -&gt; a
forall a. Mixture a =&gt; [(Double, a)] -&gt; a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var">weightedAvg</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, a)] -&gt; a) -&gt; ([a] -&gt; [(Double, a)]) -&gt; [a] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Double, a)) -&gt; [a] -&gt; [(Double, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">{-|
A wrapper to compute the expected value E[X], also known as the `Identity`.
-}</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">newtype</span><span> </span><span id="Mean"><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier hs-var">Mean</span></a></span></span><span> </span><span id="local-6989586621679066713"><span class="annot"><a href="#local-6989586621679066713"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mean"><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier hs-var">Mean</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getMean"><span class="annot"><span class="annottext">forall a. Mean a -&gt; a
</span><a href="Probability.html#getMean"><span class="hs-identifier hs-var hs-var">getMean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066713"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066902"><span id="local-6989586621679066907"><span id="local-6989586621679066911"><span class="annot"><span class="annottext">Int -&gt; Mean a -&gt; ShowS
[Mean a] -&gt; ShowS
Mean a -&gt; String
(Int -&gt; Mean a -&gt; ShowS)
-&gt; (Mean a -&gt; String) -&gt; ([Mean a] -&gt; ShowS) -&gt; Show (Mean a)
forall a. Show a =&gt; Int -&gt; Mean a -&gt; ShowS
forall a. Show a =&gt; [Mean a] -&gt; ShowS
forall a. Show a =&gt; Mean a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Mean a -&gt; ShowS
showsPrec :: Int -&gt; Mean a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Mean a -&gt; String
show :: Mean a -&gt; String
$cshowList :: forall a. Show a =&gt; [Mean a] -&gt; ShowS
showList :: [Mean a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066916"><span id="local-6989586621679066920"><span id="local-6989586621679066924"><span id="local-6989586621679066928"><span id="local-6989586621679066932"><span id="local-6989586621679066936"><span id="local-6989586621679066940"><span class="annot"><span class="annottext">Integer -&gt; Mean a
Mean a -&gt; Mean a
Mean a -&gt; Mean a -&gt; Mean a
(Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Integer -&gt; Mean a)
-&gt; Num (Mean a)
forall a. Num a =&gt; Integer -&gt; Mean a
forall a. Num a =&gt; Mean a -&gt; Mean a
forall a. Num a =&gt; Mean a -&gt; Mean a -&gt; Mean a
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: forall a. Num a =&gt; Mean a -&gt; Mean a -&gt; Mean a
+ :: Mean a -&gt; Mean a -&gt; Mean a
$c- :: forall a. Num a =&gt; Mean a -&gt; Mean a -&gt; Mean a
- :: Mean a -&gt; Mean a -&gt; Mean a
$c* :: forall a. Num a =&gt; Mean a -&gt; Mean a -&gt; Mean a
* :: Mean a -&gt; Mean a -&gt; Mean a
$cnegate :: forall a. Num a =&gt; Mean a -&gt; Mean a
negate :: Mean a -&gt; Mean a
$cabs :: forall a. Num a =&gt; Mean a -&gt; Mean a
abs :: Mean a -&gt; Mean a
$csignum :: forall a. Num a =&gt; Mean a -&gt; Mean a
signum :: Mean a -&gt; Mean a
$cfromInteger :: forall a. Num a =&gt; Integer -&gt; Mean a
fromInteger :: Integer -&gt; Mean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066950"><span id="local-6989586621679066954"><span id="local-6989586621679066958"><span class="annot"><span class="annottext">Num (Mean a)
Num (Mean a) =&gt;
(Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Rational -&gt; Mean a)
-&gt; Fractional (Mean a)
Rational -&gt; Mean a
Mean a -&gt; Mean a
Mean a -&gt; Mean a -&gt; Mean a
forall a. Fractional a =&gt; Num (Mean a)
forall a. Fractional a =&gt; Rational -&gt; Mean a
forall a. Fractional a =&gt; Mean a -&gt; Mean a
forall a. Fractional a =&gt; Mean a -&gt; Mean a -&gt; Mean a
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: forall a. Fractional a =&gt; Mean a -&gt; Mean a -&gt; Mean a
/ :: Mean a -&gt; Mean a -&gt; Mean a
$crecip :: forall a. Fractional a =&gt; Mean a -&gt; Mean a
recip :: Mean a -&gt; Mean a
$cfromRational :: forall a. Fractional a =&gt; Rational -&gt; Mean a
fromRational :: Rational -&gt; Mean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066969"><span id="local-6989586621679066973"><span id="local-6989586621679066977"><span id="local-6989586621679066981"><span id="local-6989586621679066985"><span id="local-6989586621679066989"><span id="local-6989586621679066993"><span id="local-6989586621679066997"><span id="local-6989586621679067001"><span id="local-6989586621679067005"><span id="local-6989586621679067009"><span id="local-6989586621679067013"><span id="local-6989586621679067017"><span id="local-6989586621679067021"><span id="local-6989586621679067025"><span id="local-6989586621679067029"><span id="local-6989586621679067033"><span id="local-6989586621679067037"><span id="local-6989586621679067041"><span id="local-6989586621679067045"><span id="local-6989586621679067049"><span id="local-6989586621679067053"><span class="annot"><span class="annottext">Fractional (Mean a)
Mean a
Fractional (Mean a) =&gt;
Mean a
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a)
-&gt; Floating (Mean a)
Mean a -&gt; Mean a
Mean a -&gt; Mean a -&gt; Mean a
forall a. Floating a =&gt; Fractional (Mean a)
forall a. Floating a =&gt; Mean a
forall a. Floating a =&gt; Mean a -&gt; Mean a
forall a. Floating a =&gt; Mean a -&gt; Mean a -&gt; Mean a
forall a.
Fractional a =&gt;
a
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; Floating a
$cpi :: forall a. Floating a =&gt; Mean a
pi :: Mean a
$cexp :: forall a. Floating a =&gt; Mean a -&gt; Mean a
exp :: Mean a -&gt; Mean a
$clog :: forall a. Floating a =&gt; Mean a -&gt; Mean a
log :: Mean a -&gt; Mean a
$csqrt :: forall a. Floating a =&gt; Mean a -&gt; Mean a
sqrt :: Mean a -&gt; Mean a
$c** :: forall a. Floating a =&gt; Mean a -&gt; Mean a -&gt; Mean a
** :: Mean a -&gt; Mean a -&gt; Mean a
$clogBase :: forall a. Floating a =&gt; Mean a -&gt; Mean a -&gt; Mean a
logBase :: Mean a -&gt; Mean a -&gt; Mean a
$csin :: forall a. Floating a =&gt; Mean a -&gt; Mean a
sin :: Mean a -&gt; Mean a
$ccos :: forall a. Floating a =&gt; Mean a -&gt; Mean a
cos :: Mean a -&gt; Mean a
$ctan :: forall a. Floating a =&gt; Mean a -&gt; Mean a
tan :: Mean a -&gt; Mean a
$casin :: forall a. Floating a =&gt; Mean a -&gt; Mean a
asin :: Mean a -&gt; Mean a
$cacos :: forall a. Floating a =&gt; Mean a -&gt; Mean a
acos :: Mean a -&gt; Mean a
$catan :: forall a. Floating a =&gt; Mean a -&gt; Mean a
atan :: Mean a -&gt; Mean a
$csinh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
sinh :: Mean a -&gt; Mean a
$ccosh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
cosh :: Mean a -&gt; Mean a
$ctanh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
tanh :: Mean a -&gt; Mean a
$casinh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
asinh :: Mean a -&gt; Mean a
$cacosh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
acosh :: Mean a -&gt; Mean a
$catanh :: forall a. Floating a =&gt; Mean a -&gt; Mean a
atanh :: Mean a -&gt; Mean a
$clog1p :: forall a. Floating a =&gt; Mean a -&gt; Mean a
log1p :: Mean a -&gt; Mean a
$cexpm1 :: forall a. Floating a =&gt; Mean a -&gt; Mean a
expm1 :: Mean a -&gt; Mean a
$clog1pexp :: forall a. Floating a =&gt; Mean a -&gt; Mean a
log1pexp :: Mean a -&gt; Mean a
$clog1mexp :: forall a. Floating a =&gt; Mean a -&gt; Mean a
log1mexp :: Mean a -&gt; Mean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Floating</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067061"><span id="local-6989586621679067065"><span class="annot"><span class="annottext">Mean a -&gt; Mean a -&gt; Bool
(Mean a -&gt; Mean a -&gt; Bool)
-&gt; (Mean a -&gt; Mean a -&gt; Bool) -&gt; Eq (Mean a)
forall a. Eq a =&gt; Mean a -&gt; Mean a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Mean a -&gt; Mean a -&gt; Bool
== :: Mean a -&gt; Mean a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Mean a -&gt; Mean a -&gt; Bool
/= :: Mean a -&gt; Mean a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067075"><span id="local-6989586621679067079"><span id="local-6989586621679067083"><span id="local-6989586621679067087"><span id="local-6989586621679067091"><span id="local-6989586621679067095"><span id="local-6989586621679067099"><span class="annot"><span class="annottext">Eq (Mean a)
Eq (Mean a) =&gt;
(Mean a -&gt; Mean a -&gt; Ordering)
-&gt; (Mean a -&gt; Mean a -&gt; Bool)
-&gt; (Mean a -&gt; Mean a -&gt; Bool)
-&gt; (Mean a -&gt; Mean a -&gt; Bool)
-&gt; (Mean a -&gt; Mean a -&gt; Bool)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; (Mean a -&gt; Mean a -&gt; Mean a)
-&gt; Ord (Mean a)
Mean a -&gt; Mean a -&gt; Bool
Mean a -&gt; Mean a -&gt; Ordering
Mean a -&gt; Mean a -&gt; Mean a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Mean a)
forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Bool
forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Ordering
forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Mean a
$ccompare :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Ordering
compare :: Mean a -&gt; Mean a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Bool
&lt; :: Mean a -&gt; Mean a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Bool
&lt;= :: Mean a -&gt; Mean a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Bool
&gt; :: Mean a -&gt; Mean a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Bool
&gt;= :: Mean a -&gt; Mean a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Mean a
max :: Mean a -&gt; Mean a -&gt; Mean a
$cmin :: forall a. Ord a =&gt; Mean a -&gt; Mean a -&gt; Mean a
min :: Mean a -&gt; Mean a -&gt; Mean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">{-| The class of statistics containing enough informations to calculate an expected value.

Remark, if `HasMean a r`, `Mixture a`, and `Mixture r`, it does not necessarily hold that `mean . weightedAvg == weightedAvg . fmap (second mean)`.
For example, see `Log1P`.
-}</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">class</span><span> </span><span id="HasMean"><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-var">HasMean</span></a></span></span><span> </span><span id="local-6989586621679066740"><span class="annot"><a href="#local-6989586621679066740"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679066741"><span class="annot"><a href="#local-6989586621679066741"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679066740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066741"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- | Extract the expected value. Generally this should satisfy `mean . fromRational = id`.</span><span>
</span><span id="line-55"></span><span>    </span><span id="mean"><span class="annot"><a href="Probability.html#mean"><span class="hs-identifier hs-type">mean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066741"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066742"><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier hs-type">Mean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066742"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679067110"><span class="annot"><span class="annottext">mean :: Mean a -&gt; a
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var hs-var hs-var hs-var">mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mean a -&gt; a
forall a. Mean a -&gt; a
</span><a href="Probability.html#getMean"><span class="hs-identifier hs-var">getMean</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066744"><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679066744"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier hs-type">Mean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066744"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679067124"><span class="annot"><span class="annottext">weightedAvg :: [(Double, Mean a)] -&gt; Mean a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var hs-var hs-var hs-var">weightedAvg</span></a></span></span><span> </span><span id="local-6989586621679067125"><span class="annot"><span class="annottext">[(Double, Mean a)]
</span><a href="#local-6989586621679067125"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Mean a
forall a. a -&gt; Mean a
</span><a href="Probability.html#Mean"><span class="hs-identifier hs-var">Mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Mean a) -&gt; a -&gt; Mean a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; a
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067127"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067129"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067127"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067127"><span class="hs-identifier hs-var">wi</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Probability.html#Mean"><span class="hs-identifier hs-type">Mean</span></a></span><span> </span><span id="local-6989586621679067129"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067129"><span class="hs-identifier hs-var">xi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Mean a)]
</span><a href="#local-6989586621679067125"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067131"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679067131"><span class="annot"><span class="annottext">w :: a
</span><a href="#local-6989586621679067131"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; a
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; a) -&gt; Double -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Double, Mean a) -&gt; Double) -&gt; [(Double, Mean a)] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Double, Mean a) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Mean a)]
</span><a href="#local-6989586621679067125"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><span class="hs-comment">{-|
A wrapper to compute the expected value of the logarithm of X plus one, E[log(1 + X)].
This is equivalent to the logarithm of the expected geometric growth rate.

Note that all this does is map an incoming value `x` to `log (1 + x)` and outgoing values `x` to `exp(x) - 1`.
-}</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="Log1P"><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span></span><span> </span><span id="local-6989586621679066754"><span class="annot"><a href="#local-6989586621679066754"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Log1P"><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getLog1P"><span class="annot"><span class="annottext">forall a. Log1P a -&gt; a
</span><a href="Probability.html#getLog1P"><span class="hs-identifier hs-var hs-var">getLog1P</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067142"><span id="local-6989586621679067146"><span id="local-6989586621679067150"><span class="annot"><span class="annottext">Int -&gt; Log1P a -&gt; ShowS
[Log1P a] -&gt; ShowS
Log1P a -&gt; String
(Int -&gt; Log1P a -&gt; ShowS)
-&gt; (Log1P a -&gt; String) -&gt; ([Log1P a] -&gt; ShowS) -&gt; Show (Log1P a)
forall a. Show a =&gt; Int -&gt; Log1P a -&gt; ShowS
forall a. Show a =&gt; [Log1P a] -&gt; ShowS
forall a. Show a =&gt; Log1P a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Log1P a -&gt; ShowS
showsPrec :: Int -&gt; Log1P a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Log1P a -&gt; String
show :: Log1P a -&gt; String
$cshowList :: forall a. Show a =&gt; [Log1P a] -&gt; ShowS
showList :: [Log1P a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067153"><span id="local-6989586621679067155"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b)
-&gt; (forall a b. a -&gt; Log1P b -&gt; Log1P a) -&gt; Functor Log1P
forall a b. a -&gt; Log1P b -&gt; Log1P a
forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
fmap :: forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
$c&lt;$ :: forall a b. a -&gt; Log1P b -&gt; Log1P a
&lt;$ :: forall a b. a -&gt; Log1P b -&gt; Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067160"><span id="local-6989586621679067164"><span class="annot"><span class="annottext">Log1P a
Log1P a -&gt; Log1P a -&gt; Bounded (Log1P a)
forall a. a -&gt; a -&gt; Bounded a
forall a. Bounded a =&gt; Log1P a
$cminBound :: forall a. Bounded a =&gt; Log1P a
minBound :: Log1P a
$cmaxBound :: forall a. Bounded a =&gt; Log1P a
maxBound :: Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679067173"><span id="local-6989586621679067178"><span id="local-6989586621679067181"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679067184"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Log1P a
forall a. a -&gt; Log1P a
</span><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679067185"><span class="annot"><span class="annottext">liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Log1P a -&gt; Log1P b -&gt; Log1P c
</span><a href="#local-6989586621679067185"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftA2</span></a></span></span><span> </span><span id="local-6989586621679067187"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679067187"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span id="local-6989586621679067188"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067188"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span id="local-6989586621679067189"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067189"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; Log1P c
forall a. a -&gt; Log1P a
</span><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679067187"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067188"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067189"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066780"><span id="local-6989586621679067193"><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679066780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679067205"><span class="annot"><span class="annottext">+ :: Log1P a -&gt; Log1P a -&gt; Log1P a
</span><a href="#local-6989586621679067205"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Log1P a -&gt; Log1P a -&gt; Log1P a
forall a b c. (a -&gt; b -&gt; c) -&gt; Log1P a -&gt; Log1P b -&gt; Log1P c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679067209"><span class="annot"><span class="annottext">* :: Log1P a -&gt; Log1P a -&gt; Log1P a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Log1P a -&gt; Log1P a -&gt; Log1P a
forall a b c. (a -&gt; b -&gt; c) -&gt; Log1P a -&gt; Log1P b -&gt; Log1P c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679067212"><span class="annot"><span class="annottext">abs :: Log1P a -&gt; Log1P a
</span><a href="#local-6989586621679067212"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Log1P a -&gt; Log1P a
forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679067216"><span class="annot"><span class="annottext">signum :: Log1P a -&gt; Log1P a
</span><a href="#local-6989586621679067216"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Log1P a -&gt; Log1P a
forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679067222"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Log1P a
forall a. a -&gt; Log1P a
</span><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Log1P a) -&gt; (Integer -&gt; a) -&gt; Integer -&gt; Log1P a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Integer -&gt; a) -&gt; Integer -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Integer -&gt; a) -&gt; Integer -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679067226"><span class="annot"><span class="annottext">negate :: Log1P a -&gt; Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Log1P a -&gt; Log1P a
forall a b. (a -&gt; b) -&gt; Log1P a -&gt; Log1P b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066782"><span id="local-6989586621679067232"><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679066782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679067242"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; Log1P a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Log1P a
forall a. a -&gt; Log1P a
</span><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Log1P a) -&gt; (Rational -&gt; a) -&gt; Rational -&gt; Log1P a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Rational -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Rational -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; a
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679067245"><span class="annot"><span class="annottext">/ :: Log1P a -&gt; Log1P a -&gt; Log1P a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(/)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Log1P a -&gt; Log1P a -&gt; Log1P a
forall a b c. (a -&gt; b -&gt; c) -&gt; Log1P a -&gt; Log1P b -&gt; Log1P c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066785"><span id="local-6989586621679066786"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066786"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679066786"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066785"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066786"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679067256"><span class="annot"><span class="annottext">mean :: Log1P a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var hs-var hs-var hs-var">mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; (Log1P a -&gt; r) -&gt; Log1P a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; (Log1P a -&gt; r) -&gt; Log1P a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (Log1P a -&gt; a) -&gt; Log1P a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Log1P a -&gt; a
forall a. Log1P a -&gt; a
</span><a href="Probability.html#getLog1P"><span class="hs-identifier hs-var">getLog1P</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066788"><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679066788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679067269"><span class="annot"><span class="annottext">weightedAvg :: [(Double, Log1P a)] -&gt; Log1P a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var hs-var hs-var hs-var">weightedAvg</span></a></span></span><span> </span><span id="local-6989586621679067270"><span class="annot"><span class="annottext">[(Double, Log1P a)]
</span><a href="#local-6989586621679067270"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Log1P a
forall a. a -&gt; Log1P a
</span><a href="Probability.html#Log1P"><span class="hs-identifier hs-var">Log1P</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Log1P a) -&gt; a -&gt; Log1P a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; a
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067271"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067272"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067271"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067271"><span class="hs-identifier hs-var">wi</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Probability.html#Log1P"><span class="hs-identifier hs-type">Log1P</span></a></span><span> </span><span id="local-6989586621679067272"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067272"><span class="hs-identifier hs-var">xi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Log1P a)]
</span><a href="#local-6989586621679067270"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067273"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679067273"><span class="annot"><span class="annottext">w :: a
</span><a href="#local-6989586621679067273"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; a
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; a) -&gt; Double -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Double, Log1P a) -&gt; Double) -&gt; [(Double, Log1P a)] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Double, Log1P a) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Log1P a)]
</span><a href="#local-6989586621679067270"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">{-|
A wrapper to search for the objective value with the maximal expected value.

This ensures that if `mean x &lt; mean y` then `MaxMean x &lt; MaxMean y`.
-}</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">newtype</span><span> </span><span id="MaxMean"><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-var">MaxMean</span></a></span></span><span> </span><span id="local-6989586621679066789"><span class="annot"><a href="#local-6989586621679066789"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MaxMean"><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-var">MaxMean</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getMaxMean"><span class="annot"><span class="annottext">forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var hs-var">getMaxMean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067284"><span id="local-6989586621679067288"><span id="local-6989586621679067292"><span class="annot"><span class="annottext">Int -&gt; MaxMean a -&gt; ShowS
[MaxMean a] -&gt; ShowS
MaxMean a -&gt; String
(Int -&gt; MaxMean a -&gt; ShowS)
-&gt; (MaxMean a -&gt; String)
-&gt; ([MaxMean a] -&gt; ShowS)
-&gt; Show (MaxMean a)
forall a. Show a =&gt; Int -&gt; MaxMean a -&gt; ShowS
forall a. Show a =&gt; [MaxMean a] -&gt; ShowS
forall a. Show a =&gt; MaxMean a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; MaxMean a -&gt; ShowS
showsPrec :: Int -&gt; MaxMean a -&gt; ShowS
$cshow :: forall a. Show a =&gt; MaxMean a -&gt; String
show :: MaxMean a -&gt; String
$cshowList :: forall a. Show a =&gt; [MaxMean a] -&gt; ShowS
showList :: [MaxMean a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067296"><span id="local-6989586621679067300"><span id="local-6989586621679067304"><span id="local-6989586621679067308"><span id="local-6989586621679067312"><span id="local-6989586621679067316"><span id="local-6989586621679067320"><span class="annot"><span class="annottext">Integer -&gt; MaxMean a
MaxMean a -&gt; MaxMean a
MaxMean a -&gt; MaxMean a -&gt; MaxMean a
(MaxMean a -&gt; MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a)
-&gt; (Integer -&gt; MaxMean a)
-&gt; Num (MaxMean a)
forall a. Num a =&gt; Integer -&gt; MaxMean a
forall a. Num a =&gt; MaxMean a -&gt; MaxMean a
forall a. Num a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
+ :: MaxMean a -&gt; MaxMean a -&gt; MaxMean a
$c- :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
- :: MaxMean a -&gt; MaxMean a -&gt; MaxMean a
$c* :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
* :: MaxMean a -&gt; MaxMean a -&gt; MaxMean a
$cnegate :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a
negate :: MaxMean a -&gt; MaxMean a
$cabs :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a
abs :: MaxMean a -&gt; MaxMean a
$csignum :: forall a. Num a =&gt; MaxMean a -&gt; MaxMean a
signum :: MaxMean a -&gt; MaxMean a
$cfromInteger :: forall a. Num a =&gt; Integer -&gt; MaxMean a
fromInteger :: Integer -&gt; MaxMean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067329"><span id="local-6989586621679067333"><span id="local-6989586621679067337"><span class="annot"><span class="annottext">Num (MaxMean a)
Num (MaxMean a) =&gt;
(MaxMean a -&gt; MaxMean a -&gt; MaxMean a)
-&gt; (MaxMean a -&gt; MaxMean a)
-&gt; (Rational -&gt; MaxMean a)
-&gt; Fractional (MaxMean a)
Rational -&gt; MaxMean a
MaxMean a -&gt; MaxMean a
MaxMean a -&gt; MaxMean a -&gt; MaxMean a
forall a. Fractional a =&gt; Num (MaxMean a)
forall a. Fractional a =&gt; Rational -&gt; MaxMean a
forall a. Fractional a =&gt; MaxMean a -&gt; MaxMean a
forall a. Fractional a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: forall a. Fractional a =&gt; MaxMean a -&gt; MaxMean a -&gt; MaxMean a
/ :: MaxMean a -&gt; MaxMean a -&gt; MaxMean a
$crecip :: forall a. Fractional a =&gt; MaxMean a -&gt; MaxMean a
recip :: MaxMean a -&gt; MaxMean a
$cfromRational :: forall a. Fractional a =&gt; Rational -&gt; MaxMean a
fromRational :: Rational -&gt; MaxMean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066800"><span id="local-6989586621679066801"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066801"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679066801"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-type">MaxMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679067348"><span class="annot"><span class="annottext">== :: MaxMean a -&gt; MaxMean a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Bool)
-&gt; (MaxMean a -&gt; r) -&gt; MaxMean a -&gt; MaxMean a -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MaxMean a -&gt; a) -&gt; MaxMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MaxMean a -&gt; a
forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var">getMaxMean</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679067351"><span class="annot"><span class="annottext">/= :: MaxMean a -&gt; MaxMean a -&gt; Bool
</span><a href="#local-6989586621679067351"><span class="hs-operator hs-var hs-var hs-var hs-var">(/=)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Bool)
-&gt; (MaxMean a -&gt; r) -&gt; MaxMean a -&gt; MaxMean a -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MaxMean a -&gt; a) -&gt; MaxMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MaxMean a -&gt; a
forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var">getMaxMean</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066807"><span id="local-6989586621679066808"><span id="local-6989586621679067361"><span id="local-6989586621679067367"><span id="local-6989586621679067372"><span id="local-6989586621679067377"><span id="local-6989586621679067382"><span id="local-6989586621679067387"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679066808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-type">MaxMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679067394"><span class="annot"><span class="annottext">compare :: MaxMean a -&gt; MaxMean a -&gt; Ordering
</span><a href="#local-6989586621679067394"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Ordering)
-&gt; (MaxMean a -&gt; r) -&gt; MaxMean a -&gt; MaxMean a -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MaxMean a -&gt; a) -&gt; MaxMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MaxMean a -&gt; a
forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var">getMaxMean</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066811"><span id="local-6989586621679066812"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066812"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-type">MaxMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066811"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066812"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679067400"><span class="annot"><span class="annottext">mean :: MaxMean a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var hs-var hs-var hs-var">mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MaxMean a -&gt; a) -&gt; MaxMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MaxMean a -&gt; a
forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var">getMaxMean</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066814"><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066814"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MaxMean"><span class="hs-identifier hs-type">MaxMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066814"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679067408"><span class="annot"><span class="annottext">weightedAvg :: [(Double, MaxMean a)] -&gt; MaxMean a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var hs-var hs-var hs-var">weightedAvg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; MaxMean a
forall a. a -&gt; MaxMean a
</span><a href="Probability.html#MaxMean"><span class="hs-identifier hs-var">MaxMean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; MaxMean a)
-&gt; ([(Double, MaxMean a)] -&gt; a)
-&gt; [(Double, MaxMean a)]
-&gt; MaxMean a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Double, a)] -&gt; a
forall a. Mixture a =&gt; [(Double, a)] -&gt; a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var">weightedAvg</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, a)] -&gt; a)
-&gt; ([(Double, MaxMean a)] -&gt; [(Double, a)])
-&gt; [(Double, MaxMean a)]
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Double, MaxMean a) -&gt; (Double, a))
-&gt; [(Double, MaxMean a)] -&gt; [(Double, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MaxMean a -&gt; a) -&gt; (Double, MaxMean a) -&gt; (Double, a)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">MaxMean a -&gt; a
forall a. MaxMean a -&gt; a
</span><a href="Probability.html#getMaxMean"><span class="hs-identifier hs-var">getMaxMean</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">{-|
A wrapper to search for the objective value with the minimal expected value.

This ensures that if `mean x &gt;= mean y` then `MinMean x &lt; MinMean y`.
-}</span></span><span>
</span><span id="line-123"></span><span class="hs-keyword">newtype</span><span> </span><span id="MinMean"><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-var">MinMean</span></a></span></span><span> </span><span id="local-6989586621679066820"><span class="annot"><a href="#local-6989586621679066820"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MinMean"><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-var">MinMean</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getMinMean"><span class="annot"><span class="annottext">forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var hs-var">getMinMean</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066820"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067413"><span id="local-6989586621679067417"><span id="local-6989586621679067421"><span class="annot"><span class="annottext">Int -&gt; MinMean a -&gt; ShowS
[MinMean a] -&gt; ShowS
MinMean a -&gt; String
(Int -&gt; MinMean a -&gt; ShowS)
-&gt; (MinMean a -&gt; String)
-&gt; ([MinMean a] -&gt; ShowS)
-&gt; Show (MinMean a)
forall a. Show a =&gt; Int -&gt; MinMean a -&gt; ShowS
forall a. Show a =&gt; [MinMean a] -&gt; ShowS
forall a. Show a =&gt; MinMean a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; MinMean a -&gt; ShowS
showsPrec :: Int -&gt; MinMean a -&gt; ShowS
$cshow :: forall a. Show a =&gt; MinMean a -&gt; String
show :: MinMean a -&gt; String
$cshowList :: forall a. Show a =&gt; [MinMean a] -&gt; ShowS
showList :: [MinMean a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067425"><span id="local-6989586621679067429"><span id="local-6989586621679067433"><span id="local-6989586621679067437"><span id="local-6989586621679067441"><span id="local-6989586621679067445"><span id="local-6989586621679067449"><span class="annot"><span class="annottext">Integer -&gt; MinMean a
MinMean a -&gt; MinMean a
MinMean a -&gt; MinMean a -&gt; MinMean a
(MinMean a -&gt; MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a)
-&gt; (Integer -&gt; MinMean a)
-&gt; Num (MinMean a)
forall a. Num a =&gt; Integer -&gt; MinMean a
forall a. Num a =&gt; MinMean a -&gt; MinMean a
forall a. Num a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: forall a. Num a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
+ :: MinMean a -&gt; MinMean a -&gt; MinMean a
$c- :: forall a. Num a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
- :: MinMean a -&gt; MinMean a -&gt; MinMean a
$c* :: forall a. Num a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
* :: MinMean a -&gt; MinMean a -&gt; MinMean a
$cnegate :: forall a. Num a =&gt; MinMean a -&gt; MinMean a
negate :: MinMean a -&gt; MinMean a
$cabs :: forall a. Num a =&gt; MinMean a -&gt; MinMean a
abs :: MinMean a -&gt; MinMean a
$csignum :: forall a. Num a =&gt; MinMean a -&gt; MinMean a
signum :: MinMean a -&gt; MinMean a
$cfromInteger :: forall a. Num a =&gt; Integer -&gt; MinMean a
fromInteger :: Integer -&gt; MinMean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067458"><span id="local-6989586621679067462"><span id="local-6989586621679067466"><span class="annot"><span class="annottext">Num (MinMean a)
Num (MinMean a) =&gt;
(MinMean a -&gt; MinMean a -&gt; MinMean a)
-&gt; (MinMean a -&gt; MinMean a)
-&gt; (Rational -&gt; MinMean a)
-&gt; Fractional (MinMean a)
Rational -&gt; MinMean a
MinMean a -&gt; MinMean a
MinMean a -&gt; MinMean a -&gt; MinMean a
forall a. Fractional a =&gt; Num (MinMean a)
forall a. Fractional a =&gt; Rational -&gt; MinMean a
forall a. Fractional a =&gt; MinMean a -&gt; MinMean a
forall a. Fractional a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: forall a. Fractional a =&gt; MinMean a -&gt; MinMean a -&gt; MinMean a
/ :: MinMean a -&gt; MinMean a -&gt; MinMean a
$crecip :: forall a. Fractional a =&gt; MinMean a -&gt; MinMean a
recip :: MinMean a -&gt; MinMean a
$cfromRational :: forall a. Fractional a =&gt; Rational -&gt; MinMean a
fromRational :: Rational -&gt; MinMean a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066831"><span id="local-6989586621679066832"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066832"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679066832"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-type">MinMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066831"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679067477"><span class="annot"><span class="annottext">== :: MinMean a -&gt; MinMean a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Bool)
-&gt; (MinMean a -&gt; r) -&gt; MinMean a -&gt; MinMean a -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MinMean a -&gt; a) -&gt; MinMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MinMean a -&gt; a
forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var">getMinMean</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679067480"><span class="annot"><span class="annottext">/= :: MinMean a -&gt; MinMean a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(/=)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Bool)
-&gt; (MinMean a -&gt; r) -&gt; MinMean a -&gt; MinMean a -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MinMean a -&gt; a) -&gt; MinMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MinMean a -&gt; a
forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var">getMinMean</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066835"><span id="local-6989586621679066836"><span id="local-6989586621679067489"><span id="local-6989586621679067495"><span id="local-6989586621679067500"><span id="local-6989586621679067505"><span id="local-6989586621679067510"><span id="local-6989586621679067515"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066835"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066836"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679066836"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-type">MinMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066835"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679067522"><span class="annot"><span class="annottext">compare :: MinMean a -&gt; MinMean a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Ordering) -&gt; r -&gt; r -&gt; Ordering
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; Ordering)
-&gt; (MinMean a -&gt; r) -&gt; MinMean a -&gt; MinMean a -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MinMean a -&gt; a) -&gt; MinMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MinMean a -&gt; a
forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var">getMinMean</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066842"><span id="local-6989586621679066843"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066842"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066843"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-type">MinMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066842"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066843"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679067528"><span class="annot"><span class="annottext">mean :: MinMean a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var hs-var hs-var hs-var">mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (MinMean a -&gt; a) -&gt; MinMean a -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MinMean a -&gt; a
forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var">getMinMean</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066845"><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066845"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#MinMean"><span class="hs-identifier hs-type">MinMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066845"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679067535"><span class="annot"><span class="annottext">weightedAvg :: [(Double, MinMean a)] -&gt; MinMean a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var hs-var hs-var hs-var">weightedAvg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; MinMean a
forall a. a -&gt; MinMean a
</span><a href="Probability.html#MinMean"><span class="hs-identifier hs-var">MinMean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; MinMean a)
-&gt; ([(Double, MinMean a)] -&gt; a)
-&gt; [(Double, MinMean a)]
-&gt; MinMean a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Double, a)] -&gt; a
forall a. Mixture a =&gt; [(Double, a)] -&gt; a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var">weightedAvg</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, a)] -&gt; a)
-&gt; ([(Double, MinMean a)] -&gt; [(Double, a)])
-&gt; [(Double, MinMean a)]
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Double, MinMean a) -&gt; (Double, a))
-&gt; [(Double, MinMean a)] -&gt; [(Double, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MinMean a -&gt; a) -&gt; (Double, MinMean a) -&gt; (Double, a)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">MinMean a -&gt; a
forall a. MinMean a -&gt; a
</span><a href="Probability.html#getMinMean"><span class="hs-identifier hs-var">getMinMean</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">{-|
A wrapper to compute the variance and expected value of X.
Requires its first argument to have expected values to work.
-}</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="Variance"><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span></span><span> </span><span id="local-6989586621679066846"><span class="annot"><a href="#local-6989586621679066846"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679066847"><span class="annot"><a href="#local-6989586621679066847"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Variance"><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unVariance"><span class="annot"><span class="annottext">forall a b. Variance a b -&gt; a
</span><a href="Probability.html#unVariance"><span class="hs-identifier hs-var hs-var">unVariance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679066846"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span id="getVariance"><span class="annot"><span class="annottext">forall a b. Variance a b -&gt; b
</span><a href="Probability.html#getVariance"><span class="hs-identifier hs-var hs-var">getVariance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679066847"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067542"><span id="local-6989586621679067547"><span id="local-6989586621679067551"><span class="annot"><span class="annottext">Int -&gt; Variance a b -&gt; ShowS
[Variance a b] -&gt; ShowS
Variance a b -&gt; String
(Int -&gt; Variance a b -&gt; ShowS)
-&gt; (Variance a b -&gt; String)
-&gt; ([Variance a b] -&gt; ShowS)
-&gt; Show (Variance a b)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a b. (Show a, Show b) =&gt; Int -&gt; Variance a b -&gt; ShowS
forall a b. (Show a, Show b) =&gt; [Variance a b] -&gt; ShowS
forall a b. (Show a, Show b) =&gt; Variance a b -&gt; String
$cshowsPrec :: forall a b. (Show a, Show b) =&gt; Int -&gt; Variance a b -&gt; ShowS
showsPrec :: Int -&gt; Variance a b -&gt; ShowS
$cshow :: forall a b. (Show a, Show b) =&gt; Variance a b -&gt; String
show :: Variance a b -&gt; String
$cshowList :: forall a b. (Show a, Show b) =&gt; [Variance a b] -&gt; ShowS
showList :: [Variance a b] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">class</span><span> </span><span id="HasVariance"><span class="annot"><a href="Probability.html#HasVariance"><span class="hs-identifier hs-var">HasVariance</span></a></span></span><span> </span><span id="local-6989586621679066866"><span class="annot"><a href="#local-6989586621679066866"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679066867"><span class="annot"><a href="#local-6989586621679066867"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679066866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066867"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span id="variance"><span class="annot"><a href="Probability.html#variance"><span class="hs-identifier hs-type">variance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679066866"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679066867"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066860"><span id="local-6989586621679066861"><span id="local-6989586621679066862"><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066860"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066861"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066860"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066862"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066861"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679067558"><span class="annot"><span class="annottext">mean :: Variance a b -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var hs-var hs-var hs-var">mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; (Variance a b -&gt; a) -&gt; Variance a b -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Variance a b -&gt; a
forall a b. Variance a b -&gt; a
</span><a href="Probability.html#unVariance"><span class="hs-identifier hs-var">unVariance</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066868"><span id="local-6989586621679066869"><span class="annot"><a href="Probability.html#HasVariance"><span class="hs-identifier hs-type">HasVariance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066868"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066869"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679066869"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679067562"><span class="annot"><span class="annottext">variance :: Variance a b -&gt; b
</span><a href="Probability.html#variance"><span class="hs-identifier hs-var hs-var hs-var hs-var">variance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Variance a b -&gt; b
forall a b. Variance a b -&gt; b
</span><a href="Probability.html#getVariance"><span class="hs-identifier hs-var">getVariance</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066872"><span id="local-6989586621679066873"><span id="local-6989586621679067568"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066872"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066873"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679066872"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679066873"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066872"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066873"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span id="local-6989586621679067578"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067578"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679067579"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067579"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679067580"><span class="annot"><span class="annottext">+ :: Variance a b -&gt; Variance a b -&gt; Variance a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span id="local-6989586621679067581"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067581"><span class="hs-identifier hs-var">my</span></a></span></span><span> </span><span id="local-6989586621679067582"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067582"><span class="hs-identifier hs-var">vy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067578"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067581"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067579"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067582"><span class="hs-identifier hs-var">vy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span id="local-6989586621679067596"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067596"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679067597"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067597"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679067598"><span class="annot"><span class="annottext">* :: Variance a b -&gt; Variance a b -&gt; Variance a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span id="local-6989586621679067599"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067599"><span class="hs-identifier hs-var">my</span></a></span></span><span> </span><span id="local-6989586621679067600"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067600"><span class="hs-identifier hs-var">vy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067596"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067599"><span class="hs-identifier hs-var">my</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067597"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067600"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067597"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067596"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067600"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067599"><span class="hs-identifier hs-var">my</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679067604"><span class="annot"><span class="annottext">abs :: Variance a b -&gt; Variance a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Variance a b -&gt; Variance a b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot take abs of Variance&quot;</span></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679067608"><span class="annot"><span class="annottext">signum :: Variance a b -&gt; Variance a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Variance a b -&gt; Variance a b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot take signum of Variance&quot;</span></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679067611"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Variance a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span id="local-6989586621679067612"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679067612"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679067614"><span class="annot"><span class="annottext">negate :: Variance a b -&gt; Variance a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span id="local-6989586621679067615"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067615"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679067616"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067616"><span class="hs-identifier hs-var">vx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067615"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067616"><span class="hs-identifier hs-var">vx</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066881"><span id="local-6989586621679066882"><span id="local-6989586621679067625"><span class="hs-special">(</span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066882"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679066881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679066882"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066882"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679067632"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; Variance a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span id="local-6989586621679067633"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679067633"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; a
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679067633"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679067636"><span class="annot"><span class="annottext">recip :: Variance a b -&gt; Variance a b
</span><a href="#local-6989586621679067636"><span class="hs-identifier hs-var hs-var hs-var hs-var">recip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Variance a b -&gt; Variance a b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot take recip of Variance&quot;</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679066885"><span id="local-6989586621679066886"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679066885"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Probability.html#HasMean"><span class="hs-identifier hs-type">HasMean</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066885"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066886"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Probability.html#Mixture"><span class="hs-identifier hs-type">Mixture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Probability.html#Variance"><span class="hs-identifier hs-type">Variance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679066885"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679067644"><span class="annot"><span class="annottext">weightedAvg :: [(Double, Variance a b)] -&gt; Variance a b
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var hs-var hs-var hs-var">weightedAvg</span></a></span></span><span> </span><span id="local-6989586621679067645"><span class="annot"><span class="annottext">[(Double, Variance a b)]
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Variance a b
forall a b. a -&gt; b -&gt; Variance a b
</span><a href="Probability.html#Variance"><span class="hs-identifier hs-var">Variance</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067646"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067647"><span class="hs-identifier hs-var">vx</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679067646"><span class="annot"><span class="annottext">mx :: a
</span><a href="#local-6989586621679067646"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, a)] -&gt; a
forall a. Mixture a =&gt; [(Double, a)] -&gt; a
</span><a href="Probability.html#weightedAvg"><span class="hs-identifier hs-var">weightedAvg</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, a)] -&gt; a) -&gt; [(Double, a)] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Double, Variance a b) -&gt; (Double, a))
-&gt; [(Double, Variance a b)] -&gt; [(Double, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Variance a b -&gt; a) -&gt; (Double, Variance a b) -&gt; (Double, a)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Variance a b -&gt; a
forall a b. Variance a b -&gt; a
</span><a href="Probability.html#unVariance"><span class="hs-identifier hs-var">unVariance</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Double, Variance a b)]
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679067647"><span class="annot"><span class="annottext">vx :: b
</span><a href="#local-6989586621679067647"><span class="hs-identifier hs-var hs-var">vx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067646"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>         </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; b
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; b
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067668"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variance a b -&gt; b
forall a r. HasVariance a r =&gt; a -&gt; r
</span><a href="Probability.html#variance"><span class="hs-identifier hs-var">variance</span></a></span><span> </span><span class="annot"><span class="annottext">Variance a b
</span><a href="#local-6989586621679067669"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Variance a b -&gt; b
forall a r. HasMean a r =&gt; a -&gt; r
</span><a href="Probability.html#mean"><span class="hs-identifier hs-var">mean</span></a></span><span> </span><span class="annot"><span class="annottext">Variance a b
</span><a href="#local-6989586621679067669"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067668"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067668"><span class="hs-identifier hs-var">wi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067669"><span class="annot"><span class="annottext">Variance a b
</span><a href="#local-6989586621679067669"><span class="hs-identifier hs-var">xi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Variance a b)]
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067670"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679067670"><span class="annot"><span class="annottext">w :: b
</span><a href="#local-6989586621679067670"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; b
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; b) -&gt; Double -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Double, Variance a b) -&gt; Double)
-&gt; [(Double, Variance a b)] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Double, Variance a b) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Variance a b)]
</span><a href="#local-6989586621679067645"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-172"></span></pre></body></html>